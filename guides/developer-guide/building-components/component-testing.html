<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/apt/guides/developer-guide/building-components/component-testing.apt at 2024-08-13
 | Rendered using Apache Maven Fluido Skin 1.11.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <meta name="author" content="Michal Maczka" />
    <meta name="date" content="2006-06-17" />
    <title>Plexus &#x2013; Developer Guide - Testing Plexus Components</title>
    <link rel="stylesheet" href="../../../css/apache-maven-fluido-1.11.2.min.css" />
    <link rel="stylesheet" href="../../../css/site.css" />
    <link rel="stylesheet" href="../../../css/print.css" media="print" />
    <script src="../../../js/apache-maven-fluido-1.11.2.min.js"></script>

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
                _paq.push(['disableCookies']);
                    _paq.push(['trackPageView']);
                    _paq.push(['enableLinkTracking']);
        
        (function() {
            var u="https://analytics.apache.org/";
            _paq.push(['setTrackerUrl', u+'/matomo.php']);
            _paq.push(['setSiteId', '18']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../../.././" id="bannerLeft"><img src="../../../images/plexus-logo-trans.png"  alt="Plexus" style="" /></a></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li><a href="../../.././" title="Plexus">Plexus</a><span class="divider">/</span></li>
      <li><a href="../../../plexus-pom" title="Parent POM">Parent POM</a><span class="divider">/</span></li>
      <li><a href="../../../" title="Plexus">Plexus</a><span class="divider">/</span></li>
    <li class="active ">Developer Guide - Testing Plexus Components <a href="https://github.com/codehaus-plexus/codehaus-plexus.github.io/tree/source/src/site/apt/guides/developer-guide/building-components/component-testing.apt"><img src="../../../images/accessories-text-editor.png" title="Edit" /></a></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2024-08-13</li>
        <li class="pull-right"><a href="http://codehaus-plexus.github.io/" class="externalLink" title="Plexus">Plexus</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Plexus</li>
    <li><a href="../../../index.html" title="Overview"><span class="none"></span>Overview</a></li>
   <li class="nav-header">Old IoC Documentation</li>
    <li><a href="../../../" title="Books"><span class="icon-chevron-down"></span>Books</a>
     <ul class="nav nav-list">
      <li><a href="../../../writing-components-trail/index.html" title="Writing Components"><span class="none"></span>Writing Components</a></li>
     </ul></li>
    <li><a href="../../../" title="Guides"><span class="icon-chevron-down"></span>Guides</a>
     <ul class="nav nav-list">
      <li><a href="../../../guides/quick-start/getting-started.html" title="Quick Start"><span class="none"></span>Quick Start</a></li>
      <li><a href="../../../guides/writing-components/00_index.html" title="Writing Plexus Components"><span class="none"></span>Writing Plexus Components</a></li>
      <li><a href="../../../guides/developer-guide/index.html" title="Developer Guide"><span class="none"></span>Developer Guide</a></li>
     </ul></li>
    <li><a href="../../../" title="Reference"><span class="icon-chevron-down"></span>Reference</a>
     <ul class="nav nav-list">
      <li><a href="../../../ref/why-use-components.html" title="Why Use Components?"><span class="none"></span>Why Use Components?</a></li>
      <li><a href="../../../ref/plexus-descriptor.html" title="Plexus Descriptor"><span class="none"></span>Plexus Descriptor</a></li>
      <li><a href="../../../guides/developer-guide/configuration/component-descriptor.html" title="Component Descriptor"><span class="none"></span>Component Descriptor</a></li>
      <li><a href="../../../ref/component-configuration.html" title="Component Configuration"><span class="none"></span>Component Configuration</a></li>
      <li><a href="../../../ref/technical-articles.html" title="Technical Articles"><span class="none"></span>Technical Articles</a></li>
      <li><a href="../../../ref/available-components.html" title="Available Components"><span class="none"></span>Available Components</a></li>
      <li><a href="../../../faq.html" title="FAQs"><span class="none"></span>FAQs</a></li>
     </ul></li>
   <li class="nav-header">Community</li>
    <li><a href="https://groups.google.com/g/mojohaus-dev" class="externalLink" title="Mailing Lists"><span class="none"></span>Mailing Lists</a></li>
    <li><a href="../../../get-involved.html" title="Get Involved"><span class="none"></span>Get Involved</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../../../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
   <li class="nav-header">Plexus Projects</li>
    <li><a href="../../../modello/" title="Modello"><span class="none"></span>Modello</a></li>
    <li><a href="../../../plexus-classworlds/" title="Plexus Classworlds"><span class="none"></span>Plexus Classworlds</a></li>
    <li><a href="../../../" title="Plexus Components"><span class="icon-chevron-down"></span>Plexus Components</a>
     <ul class="nav nav-list">
      <li><a href="../../../plexus-archiver/" title="Plexus Archiver"><span class="none"></span>Plexus Archiver</a></li>
      <li><a href="../../../plexus-cli/" title="Plexus CLI"><span class="none"></span>Plexus CLI</a></li>
      <li><a href="../../../plexus-compiler/" title="Plexus Compiler"><span class="none"></span>Plexus Compiler</a></li>
      <li><a href="../../../plexus-digest/" title="Plexus Digest"><span class="none"></span>Plexus Digest</a></li>
      <li><a href="../../../plexus-i18n/" title="Plexus i18n"><span class="none"></span>Plexus i18n</a></li>
      <li><a href="../../../plexus-interactivity/" title="Plexus Interactivity"><span class="none"></span>Plexus Interactivity</a></li>
      <li><a href="../../../plexus-interpolation/" title="Plexus Interpolation"><span class="none"></span>Plexus Interpolation</a></li>
      <li><a href="../../../plexus-io/" title="Plexus IO"><span class="none"></span>Plexus IO</a></li>
      <li><a href="../../../plexus-languages/" title="Plexus Languages"><span class="none"></span>Plexus Languages</a></li>
      <li><a href="../../../plexus-resources/" title="Plexus Resources"><span class="none"></span>Plexus Resources</a></li>
      <li><a href="../../../plexus-swizzle/" title="Plexus Swizzle"><span class="none"></span>Plexus Swizzle</a></li>
      <li><a href="../../../plexus-velocity/" title="Plexus Velocity"><span class="none"></span>Plexus Velocity</a></li>
     </ul></li>
    <li><a href="../../../" title="Plexus Parent POMs"><span class="icon-chevron-down"></span>Plexus Parent POMs</a>
     <ul class="nav nav-list">
      <li><a href="../../../plexus-pom/" title="Plexus"><span class="none"></span>Plexus</a></li>
      <li><a href="../../../plexus-components/" title="Plexus Components"><span class="none"></span>Plexus Components</a></li>
     </ul></li>
    <li><a href="../../../plexus-utils/" title="Plexus Utils"><span class="none"></span>Plexus Utils</a></li>
    <li><a href="../../../plexus-xml/" title="Plexus XML"><span class="none"></span>Plexus XML</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://codehaus-plexus.github.io/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" placeholder="Search with Google..." />
</form>
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<p><code>The contents of this document are a work in progress</code></p><section>
<h2><a name="Testing_Plexus_Components"></a>Testing Plexus Components</h2>
<p>If you are using Plexus you are going to use and most likely write your own components. In the second case you will need to be able to test them. Plexus container uses quite a rare approach for testing components: components are tested inside the container.</p>
<p>Like a fish needs water, a component by its [definition] needs a container. Fish should be only lifted from the water - its natural environment - for a short time, as fish needs water to breathe and water supports the weight of the fish. Keep the fish in water; keep the component in its natural environment - the container. As there are fishes, which are hard to catch, there are components, which are hard to test outside the container. And as there are some fishes, which can be never caught, there are some components, which practically cannot be tested outside the container.</p>
<p>Important remark: *component testing* is not exactly the same thing as *class testing*. In case of Plexus a component in the simplest possible case is a java class plus the component descriptor. Traditional unit testing allows you to test java classes, but you should be able to test if component as a whole is error free and ready to be used. It means that component's metadata must also be validated - you want to be sure that component definition was written properly, component's requirements were stated properly, correct component profile was chosen etc.</p>
<p>Another thing, which is so appealing about this approach is the fact that testing environment and production environment are exactly the same - this eliminates some surprises which otherwise would appear only when component was deployed.</p>
<p>Last but not least -although it might be counter-intuitive such approach is really making testing easier! Plexus and other lightweight containers have proven to *be a perfect mock infrastructure*: the container is used for &quot;plumbing&quot; components with its depended components. That is why a container is a perfect tool for injecting Mock implementation during test time and real implementation at the runtime.</p>
<p>Note that Plexus is quite &quot;lightweight&quot; and it usually can be embedded a couple of times per second.</p><section>
<h3><a name="Example"></a>Example</h3>
<p>Component Interface</p>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.tutorial.lesson2;

public interface HelloWorld
{
    String ROLE =  HelloWorld.class.getName();

    String getGreeting();
}</pre></div>
<p>Component Implementation:</p>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.tutorial.lesson2;

public class DefaultHelloWorld  implements HelloWorld
{
    public String getGreeting()
    {
        return &quot;Hello World!&quot;;
    }
}</pre></div>
<p>Component Test Case:</p>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.tutorial.lesson2;

import org.codehaus.plexus.PlexusTestCase;

public class DefaultHelloWorldTest
    extends PlexusTestCase
{
    public void testHelloWorld()
        throws exception
    {
        HelloWorld helloWorld = ( HelloWorld ) lookup( HelloWorld.ROLE );

        assertEquals( &quot;Hello World!&quot;, helloWorld.getGreeting() );
    }
}</pre></div>
<p>Normal [component discovery] is performed during the initialization of the test case. It means that if your component descriptor was alraedy added to /META-INF/plexus/components.xml file it will be visible during tests.</p>
<p>In case when you want to override the deafults the only thing you have to do is to create new xml file having the name which matches the class name but with extentinon &quot;.xml&quot;. This file must be placed in the same package as the class and be visible in the unit test's classpath.</p>
<p>In case of DefaultHelloWorldTest the file should be names DefaultHelloWorldTest.xml</p>
<div class="source"><pre class="prettyprint linenums">&lt;plexus&gt;
  &lt;components&gt;
    &lt;component&gt;
      &lt;role&gt;org.codehaus.plexus.tutorial.lesson2.HelloWorld&lt;/role&gt;
      &lt;implementation&gt;org.codehaus.plexus.tutorial.lesson2.DefaultHelloWorld&lt;/implementation&gt;
    &lt;/component&gt;
  &lt;/components&gt;
&lt;/plexus&gt;</pre></div></section><section>
<h3><a name="Container_Driven_Testing"></a>Container Driven Testing</h3>
<p>Now we will show an example how container can help in component testing and how it can be used for providing &quot;mock components&quot; during tests.</p>
<p>As exmplained above plexus provides a possiblity of perform lightning-fast component tests. which directly which takes place inside container. As Plexus suports IoC paradigm and it's Dependecy Injection in particular the container is a perfect envinroment for providing mock implementation of component's requirements.</p><section>
<h4><a name="Implementation:"></a>Implementation:</h4>
<div class="source"><pre class="prettyprint linenums">src\main\java\org\codehaus\plexus\example\CheeseConnoisseur.java
                                                                 \Cheese.java
                                                                 \DefaultCheeseFinder.java
                                                                 \CheeseFinder.java
                                                                 \CheeseEater.java
src\main\resources\META-INF\plexus\components.xml</pre></div></section><section>
<h4><a name="Tests:"></a>Tests:</h4>
<div class="source"><pre class="prettyprint linenums">$root\src\main\test\org\codehaus\plexus\example\
                                                                   MockCheeseFinder.java
                                                                   CheeseConnoisseurTest.java
                                                                   CheeseConnoisseurTest.xml</pre></div>
<p>Now file by file we will explain what is inside of each of files:</p>
<div class="source"><pre class="prettyprint linenums">$root\src\main\java\org\codehaus\plexus\example\Cheese.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

public class Cheese
{
    String name;

    int price;

    public Cheese( String name, int price )
    {
        this.name = name;

        this.price = price;
    }

    public String getName()
    {
        return name;
    }

    public void setName( String name )
    {
        this.name = name;
    }

    public int getPrice()
    {
        return price;
    }

    public void setPrice( int price )
    {
        this.price = price;
    }
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\main\java\org\codehaus\plexus\example\CheeseEater.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;


public interface CheeseEater
{
    String ROLE = CheeseEater.class.getName();

    Cheese chooseCheese();

}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\main\java\org\codehaus\plexus\example\CheeseFinder.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

import java.util.List;

public interface CheeseFinder
{
    String ROLE = CheeseFinder.class.getName();

    List getAllCheeses();
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\main\java\org\codehaus\plexus\example\DefaultCheeseFinder.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

import java.util.List;

public class DefaultCheeseFinder implements CheeseFinder
{

    public List getAllCheeses()
    {
        List retValue = null;

        //...

        return retValue;

    }
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\main\java\org\codehaus\plexus\example\CheeseConnoisseur.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

import java.util.Iterator;
import java.util.List;


public class CheeseConnoisseur  implements CheeseEater
{
    /**
     * @component.requirement
     */
    private CheeseFinder cheeseFinder;

    public Cheese chooseCheese()
    {
        Cheese retValue = null;

        int maxPrice = 0;

        List cheeses = cheeseFinder.getAllCheeses();

        for ( Iterator iterator = cheeses.iterator(); iterator.hasNext(); )
        {
            Cheese cheese = ( Cheese ) iterator.next();

            int currentPrice = cheese.getPrice();

            if (  currentPrice &gt; maxPrice )
            {
                retValue = cheese;

                maxPrice = currentPrice;
            }
        }

        return retValue;
    }
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\main\resources\META-INF\plexus\components.xml</pre></div>
<div class="source"><pre class="prettyprint linenums">&lt;component-set&gt;
    &lt;components&gt;
        &lt;component&gt;
            &lt;role&gt;org.codehaus.plexus.example.CheeseEater&lt;/role&gt;
            &lt;implementation&gt;org.codehaus.plexus.example.CheeseConnoisseur&lt;/implementation&gt;
            &lt;requirements&gt;
                &lt;requirement&gt;
                    &lt;role&gt;org.codehaus.plexus.example.CheeseFinder&lt;/role&gt;
                &lt;/requirement&gt;
            &lt;/requirements&gt;
        &lt;/component&gt;
    &lt;/components&gt;
&lt;/component-set&gt;</pre></div></section><section>
<h4><a name="Test_Code:"></a>Test Code:</h4>
<div class="source"><pre class="prettyprint linenums">$root\src\test\java\org\codehaus\plexus\example\CheeseConnoisseurTest.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

import org.codehaus.plexus.PlexusTestCase;

public class CheeseConnoisseurTest extends PlexusTestCase
{

    private CheeseEater connoisseur;


    protected void setUp() throws Exception
    {
        super.setUp();

        connoisseur = ( CheeseEater ) lookup( CheeseEater.ROLE );
    }

    public void testConnoisseur()
    {
       Cheese cheese = connoisseur.chooseCheese();

       assertEquals( &quot;Gruyere&quot;, cheese.getName() );
    }
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\test\java\org\codehaus\plexus\example\MockCheeseFinder.java</pre></div>
<div class="source"><pre class="prettyprint linenums">package org.codehaus.plexus.example;

import java.util.List;
import java.util.LinkedList;

public class MockCheeseFinder implements CheeseFinder
{
    public List getAllCheeses()
    {
        List retValue = new LinkedList();

        addCheese( retValue, &quot;Gruyere&quot;, 120 );

        addCheese( retValue, &quot;Appenzell&quot;, 100 );

        addCheese( retValue, &quot;Vacherin-Fribourgeois&quot;, 80 );

        return retValue;
    }

    private void addCheese( List cheeses, String name, int price )
    {
        Cheese chesee = new Cheese( name, price );

        cheeses.add( chesee );

    }
}</pre></div>
<div class="source"><pre class="prettyprint linenums">$root\src\test\java\org\codehaus\plexus\example\CheeseConnoisseurTest.xml</pre></div>
<div class="source"><pre class="prettyprint linenums">&lt;plexus&gt;
    &lt;components&gt;
        &lt;!-- We will use mock component for testing--&gt;
        &lt;component&gt;
            &lt;role&gt;org.codehaus.plexus.example.CheeseFinder&lt;/role&gt;
            &lt;implementation&gt;org.codehaus.plexus.example.MockCheeseFinder&lt;/implementation&gt;
        &lt;/component&gt;
    &lt;/components&gt;
&lt;/plexus&gt;</pre></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2001&#x2013;2024
<a href="https://codehaus-plexus.github.io/">Codehaus Plexus</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>